<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Редактор «Танковая миссия»</title>
<style>
body{margin:0;font-family:system-ui;background:#0a1020;color:#e6f1ff}
.wrap{display:grid;grid-template-columns:380px 1fr;height:100vh;gap:12px;padding:12px}
.panel{background:rgba(255,255,255,.06);border-radius:16px;padding:12px;overflow:auto}
.preview{border-radius:16px;overflow:hidden}
label{font-size:12px;opacity:.75}
input,button,textarea{
  width:100%;margin-top:6px;margin-bottom:10px;
  padding:8px;border-radius:10px;border:0;font-size:14px
}
button{background:#2a4c8a;color:#fff;font-weight:600;cursor:pointer}
button.alt{background:#444}
textarea{font-family:monospace;font-size:12px}
.item{display:flex;align-items:center;gap:8px;background:rgba(0,0,0,.25);padding:6px;border-radius:10px}
.item img{width:40px;height:40px;object-fit:contain}
.small{font-size:12px;opacity:.7}
</style>
</head>

<body>
<div class="wrap">
  <div class="panel">
    <h3>Редактор «Танковая миссия»</h3>

    <label>Танк (URL)</label>
    <input id="tankUrl">
    <button class="alt" onclick="resetTank()">Вернуть стандартный танк</button>

    <label>Ящики (URL)</label>
    <input id="boxUrl">
    <button class="alt" onclick="resetBox()">Вернуть стандартные ящики</button>

    <label>Фон поля (URL)</label>
    <input id="bgUrl">

    <label>Звук выстрела (URL)</label>
    <input id="shotSound">

    <label>Звук попадания (URL)</label>
    <input id="hitSound">

    <label>Количество ящиков (1–15)</label>
    <input id="boxCount" type="number" min="1" max="15" value="5">

    <hr>

    <h4>Награды (картинки)</h4>

    <label>URL картинки награды</label>
    <input id="itemUrl">
    <button onclick="addItem()">Добавить награду</button>

    <div id="items"></div>

    <hr>

    <button onclick="update()">Обновить предпросмотр</button>
    <button onclick="copy()">Скопировать код</button>

    <label>iframe для Genially</label>
    <textarea id="out" rows="4" readonly></textarea>
  </div>

  <div class="preview">
    <iframe id="game" style="width:100%;height:100%;border:0"></iframe>
  </div>
</div>

<script>
const DEFAULT_TANK =
"https://img.genially.com/66f849d0f7b39c0016fdd814/552d49a1-b37f-40f1-a992-18c2aa55ed84.gif";
const DEFAULT_BOX =
"https://img.genially.com/66f849d0f7b39c0016fdd814/9bfc40ad-c0ef-4bb9-a006-30014520bb33.png";

tankUrl.value = DEFAULT_TANK;
boxUrl.value = DEFAULT_BOX;

const rewards = [];

function resetTank(){ tankUrl.value = DEFAULT_TANK; update(); }
function resetBox(){ boxUrl.value = DEFAULT_BOX; update(); }

function addItem(){
  if(!itemUrl.value) return;
  rewards.push(itemUrl.value);
  renderItems();
  itemUrl.value="";
}

function renderItems(){
  items.innerHTML="";
  rewards.forEach((url,i)=>{
    const d=document.createElement("div");
    d.className="item";
    d.innerHTML=`<img src="${url}"><span class="small">Награда</span>
    <button onclick="removeItem(${i})">×</button>`;
    items.appendChild(d);
  });
}
function removeItem(i){ rewards.splice(i,1); renderItems(); }

function cfg(){
  return {
    tankUrl:tankUrl.value,
    boxUrl:boxUrl.value,
    bgUrl:bgUrl.value,
    shotSound:shotSound.value,
    hitSound:hitSound.value,
    boxCount:+boxCount.value,
    rewards
  };
}

function update(){
  const c = encodeURIComponent(JSON.stringify(cfg()));
  const src = "../game/index.html?config=" + c;
  game.src = src;
  out.value =
`<iframe style="width:100%;height:100%;border:0"
src="https://naasi090574.github.io/tank-mission-2026/game/index.html?config=${c}">
</iframe>`;
}

function copy(){
  out.select();
  document.execCommand("copy");
}

update();
</script>
</body>
</html>
