<!-- editor/index.html -->
<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Редактор — Танковая миссия</title>
<style>
body{margin:0;background:#0a1020;color:#d9ecff;font-family:system-ui}
.app{display:grid;grid-template-columns:380px 1fr;height:100vh;gap:10px;padding:10px}
.panel{background:#111a33;padding:12px;border-radius:14px;overflow:auto}
label{font-size:12px;color:#9bb7d6}
input,select,button{width:100%;margin-top:6px;padding:8px;border-radius:10px}
iframe{width:100%;height:100%;border:0;border-radius:14px}
</style>
</head>
<body>

<div class="app">
<div class="panel">
  <label>Ящиков (1–15)</label>
  <input id="boxCount" type="number" min="1" max="15" value="7">

  <label>Размер танка (0.5–5)</label>
  <input id="tankScale" type="number" min="0.5" max="5" step="0.1" value="1">

  <label>Размер ящика (0.5–5)</label>
  <input id="boxScale" type="number" min="0.5" max="5" step="0.1" value="1">

  <button onclick="send()">Обновить предпросмотр</button>
  <button onclick="copy()">Копировать iframe</button>
</div>

<iframe id="prev"></iframe>
</div>

<script>
const prev=document.getElementById("prev");
prev.src="../game/index.html";

function cfg(){
  return {
    boxCount:+boxCount.value,
    tankScale:+tankScale.value,
    boxScale:+boxScale.value
  };
}

function send(){
  prev.contentWindow.postMessage({type:"TANK_MISSION_CONFIG",payload:cfg()},"*");
}

function copy(){
  const c=encodeURIComponent(JSON.stringify(cfg()));
  const url=`https://naasi090574.github.io/tank-mission-2026/game/index.html?config=${c}`;
  navigator.clipboard.writeText(`<iframe style="width:100%;height:100%;border:0" src="${url}"></iframe>`);
  alert("iframe скопирован");
}

prev.onload=send;
</script>
</body>
</html>
