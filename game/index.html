<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Танчики</title>
<style>
html,body{margin:0;height:100%;background:#000}
canvas{display:block}
</style>
</head>
<body>
<canvas id="c"></canvas>

<script>
const cfg = JSON.parse(decodeURIComponent(
  new URLSearchParams(location.search).get("config") || "{}"
));

const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize(); addEventListener("resize",resize);

const tankImg = new Image(); tankImg.src = cfg.tankUrl;
const boxImg  = new Image(); boxImg.src  = cfg.boxUrl;
const bgImg   = new Image(); if(cfg.bgUrl) bgImg.src = cfg.bgUrl;

const boxes=[];
for(let i=0;i<(cfg.boxCount||7);i++){
  boxes.push({x:Math.random()*innerWidth,y:Math.random()*innerHeight});
}

function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if(cfg.bgUrl && bgImg.complete)
    ctx.drawImage(bgImg,0,0,canvas.width,canvas.height);

  boxes.forEach(b=>{
    if(boxImg.complete) ctx.drawImage(boxImg,b.x,b.y,80,80);
  });

  if(tankImg.complete)
    ctx.drawImage(tankImg,40,canvas.height-120,100,80);

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
